## 2021-1-12

###安装xrdp用到

```
chcon -h system_u:object_r:bin_t:s0 /usr/sbin/xrdp
chcon -h system_u:object_r:bin_t:s0 /usr/sbin/xrdp-sesman
```

### GPU服务器安装x windows后startx失败解决

报错

```
no screens found
```

执行

```shell
root #nvidia-xconfig #仍然失败，

查看日志vi /var/log/Xorg.1.log，决定重装nvidia驱动

仍报错“Failed to load module "glxservernvidia" (module does not exist, 0)”

/etc/X11 文件夹下的conf文件删除
```

## 2021-1-15

cetnos 7 server带桌面 安装nvidia驱动问题：

问题1：

```
You appear to be running an X server
```

解决：

```
init 3 #切换到文本模式
```

问题2：

```
ERROR: The Nouveau kernel driver is currently in use by your system. This

    driver is incompatible with the NVIDIA driver, and must be disabled

    before proceeding. Please consult the NVIDIA driver README and your

    Linux distribution's documentation for details on how to correctly

    disable the Nouveau kernel driver.
```

解决：

```
解决办法如下：

    也即关闭Nouveau：

    1)把驱动加入黑名单中: /etc/modprobe.d/blacklist.conf 在后面加入：

    blacklist nouveau

    2) 使用 dracut重新建立 initramfs image file :

    * 备份 the initramfs file

    $ sudo mv /boot/initramfs-$(uname -r).img /boot/initramfs-$(uname -r).img.bak

    * 重新建立 the initramfs file

    $ sudo dracut -v /boot/initramfs-$(uname -r).img $(uname -r)

    3) 重启系统至文本模式,init 3 这个可以修改/etc/inittab 文件 init 3是文本模式,

    init 5是图形界面模式.重启之后,进入文本模式，其实可以发现字体变大了,也就是说驱动没有被加载,成功禁用了Nouveau

    4)检查nouveau driver确保没有被加载！

    $ lsmod | grep nouveau
```

###Centos7 安装VNC实现远程桌面

https://blog.csdn.net/weixin_41004350/article/details/80805927

###Centos xrdp 远程连接后突然闪退

原因见：https://blog.csdn.net/weixin_38170829/article/details/101087050?utm_medium=distribute.pc_relevant.none-task-blog-searchFromBaidu-1.control&depth_1-utm_source=distribute.pc_relevant.none-task-blog-searchFromBaidu-1.control

解决，修改~/.bashrc文件

```shell
# .bashrc

# User specific aliases and functions

alias rm='rm -i'
alias cp='cp -i'
alias mv='mv -i'

# Source global definitions
if [ -f /etc/bashrc ]; then
        . /etc/bashrc
fi

:<<!
#>>> conda initialize >>>
# !! Contents within this block are managed by 'conda init' !!
__conda_setup="$('/home/anaconda3/bin/conda' 'shell.bash' 'hook' 2> /dev/null)"
if [ $? -eq 0 ]; then
    eval "$__conda_setup"
else
    if [ -f "/home/anaconda3/etc/profile.d/conda.sh" ]; then
        . "/home/anaconda3/etc/profile.d/conda.sh"
    else
        export PATH="/home/anaconda3/bin:$PATH"
    fi
fi
unset __conda_setup
#<<< conda initialize <<<
!

export PATH=$PATH:/home/anaconda3/bin:/home/anaconda3/condabin
```

```shell
[root@localhost ~]# echo $PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/home/anaconda3/bin:/home/anaconda3/condabin:/root/bin
```



### 寒武纪服务器上从github快速下载

```shell
#例子
wget -c -O "pcl-1.11.1.source.tar.gz" "https://github-production-release-asset-2e65be.s3.amazonaws.com/8162615/b01c9780-de82-11ea-84fe-ed209592d841?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20210115%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20210115T064425Z&X-Amz-Expires=300&X-Amz-Signature=a01c0a2ecb578b4d7ca39442be98bbf4830bb2cb55caa817833b21c723dc8929&X-Amz-SignedHeaders=host&actor_id=2957099&key_id=0&repo_id=8162615&response-content-disposition=attachment%3B%20filename%3Dsource.tar.gz&response-content-type=application%2Foctet-stream"
```

### centos 7安装cmake 3

https://tlanyan.me/install-cmake3-on-centos-7/

## 2021-1-16

### boost编译安装

https://blog.csdn.net/u011641865/article/details/73498533

### openni 编译安装(编译失败)

https://github.com/OpenNI/OpenNI

## 2021-1-18

### vncserver 设置屏幕分辨率

https://blog.csdn.net/yangcs2009/article/details/9789845

### xrdp+vnc的复制黏贴问题

https://blog.csdn.net/dongfangxiaozi_/article/details/72621974?utm_medium=distribute.pc_relevant_bbs_down.none-task--2~all~sobaiduend~default-3.nonecase&depth_1-utm_source=distribute.pc_relevant_bbs_down.none-task--2~all~sobaiduend~default-3.nonecase

上面的方法，一锁屏就失效，

https://www.cnblogs.com/zhaopengcheng/p/6067262.html

windows侧也要设置下https://www.huaweicloud.com/articles/dd5dd28089d34bb4886c8b2fae6b85b6.html



###  conda activate报错

https://blog.csdn.net/weixin_42652125/article/details/87697902

### 日常操作

```
scp -P 32285  root@120.236.247.203:/home/datasets/semantic3d/bildstein_station1_xyz_intensity_rgb.7z ./

scp -P 32285  root@120.236.247.203:/home/datasets/semantic3d/sem8_labels_training.7z ./
scp -P 32285  root@120.236.247.203:/home/datasets/semantic3d/sg27_station2_intensity_rgb.7z ./


wget -c -O "sg27_station2_intensity_rgb.7z" "http://semantic3d.net/data/point-clouds/training1/sg27_station2_intensity_rgb.7z"

/home/disk1/NuScenes/nuscenes/     10.45.157.0/20(rw,sync,no_root_squash,no_all_squash)
```

### anaconda 国内镜像

https://blog.csdn.net/weixin_43667077/article/details/106521015

### nfs 配置

https://abelsu7.top/2019/10/17/centos7-install-nfs/

https://www.itread01.com/content/1535442980.html

## 2021-1-19

### centerpoint 操作

```shell
# nuScenes
python tools/create_data.py nuscenes_data_prep --root_path=/home/znv/code/centerpoint_prj/CenterPoint/data/nuScenes --version="v1.0-trainval" --nsweeps=10



# set the cuda path(change the path to your own cuda location) 
#export PATH=/usr/local/cuda/bin:$PATH #这个环境变量不需要，加上会有问题@20210123
export CUDA_PATH=/usr/local/cuda
export CUDA_HOME=/usr/local/cuda
export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH
bash setup.sh 
```

```shell
#遇到报错
(centerpoint) [root@localhost CenterPoint]# python tools/demo.py 
iou3d cuda not built. You don't need this if you use circle_nms. Otherwise, refer to the advanced installation part to build this cuda extension
No Tensorflow
Deformable Convolution not built!
Traceback (most recent call last):
  File "tools/demo.py", line 16, in <module>
    from det3d.models import build_detector
  File "/home/znv/code/centerpoint_prj/CenterPoint/det3d/models/__init__.py", line 29, in <module>
    from .roi_heads import * 
  File "/home/znv/code/centerpoint_prj/CenterPoint/det3d/models/roi_heads/__init__.py", line 1, in <module>
    from .roi_head_template import RoIHeadTemplate
  File "/home/znv/code/centerpoint_prj/CenterPoint/det3d/models/roi_heads/roi_head_template.py", line 12, in <module>
    from .target_assigner.proposal_target_layer import ProposalTargetLayer
  File "/home/znv/code/centerpoint_prj/CenterPoint/det3d/models/roi_heads/target_assigner/proposal_target_layer.py", line 11, in <module>
    from ....ops.iou3d_nms.iou3d_nms_utils import boxes_iou3d_gpu
  File "/home/znv/code/centerpoint_prj/CenterPoint/det3d/ops/iou3d_nms/__init__.py", line 1, in <module>
    from det3d.ops.iou3d_nms import iou3d_nms_cuda, iou3d_nms_utils
ImportError: /home/znv/code/centerpoint_prj/CenterPoint/det3d/ops/iou3d_nms/iou3d_nms_cuda.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZN3c105ErrorC1ENS_14SourceLocationERKSs

(centerpoint) [root@localhost CenterPoint]# readelf -d /home/znv/code/centerpoint_prj/CenterPoint/det3d/ops/iou3d_nms/iou3d_nms_cuda.cpython-36m-x86_64-linux-gnu.so

Dynamic section at offset 0x4fbc8 contains 30 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libcudart.so.10.0]
 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libpthread.so.0]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000f (RPATH)              Library rpath: [/home/anaconda3/envs/centerpoint/lib:usr/local/cuda/lib]
 0x000000000000000c (INIT)               0x7000
 0x000000000000000d (FINI)               0x1834c
 0x0000000000000019 (INIT_ARRAY)         0x509b0
 0x000000000000001b (INIT_ARRAYSZ)       40 (bytes)
 0x000000000000001a (FINI_ARRAY)         0x509d8
 0x000000000000001c (FINI_ARRAYSZ)       8 (bytes)
 0x000000006ffffef5 (GNU_HASH)           0x260
 0x0000000000000005 (STRTAB)             0x1fc8
 0x0000000000000006 (SYMTAB)             0x420
 0x000000000000000a (STRSZ)              8111 (bytes)
 0x000000000000000b (SYMENT)             24 (bytes)
 0x0000000000000003 (PLTGOT)             0x51000
 0x0000000000000002 (PLTRELSZ)           4776 (bytes)
 0x0000000000000014 (PLTREL)             RELA
 0x0000000000000017 (JMPREL)             0x4fb8
 0x0000000000000007 (RELA)               0x42f8
 0x0000000000000008 (RELASZ)             3264 (bytes)
 0x0000000000000009 (RELAENT)            24 (bytes)
 0x000000006ffffffe (VERNEED)            0x41c8
 0x000000006fffffff (VERNEEDNUM)         6
 0x000000006ffffff0 (VERSYM)             0x3f78
 0x000000006ffffff9 (RELACOUNT)          31
 0x0000000000000000 (NULL)               0x0
 
 (centerpoint) [root@localhost CenterPoint]# chrpath -r "/usr/local/cuda/lib64"  /home/znv/code/centerpoint_prj/CenterPoint/det3d/ops/iou3d_nms/iou3d_nms_cuda.cpython-36m-x86_64-linux-gnu.so
/home/znv/code/centerpoint_prj/CenterPoint/det3d/ops/iou3d_nms/iou3d_nms_cuda.cpython-36m-x86_64-linux-gnu.so: RPATH=/home/anaconda3/envs/centerpoint/lib
/home/znv/code/centerpoint_prj/CenterPoint/det3d/ops/iou3d_nms/iou3d_nms_cuda.cpython-36m-x86_64-linux-gnu.so: new RPATH: /usr/local/cuda/lib64
(centerpoint) [root@localhost CenterPoint]# readelf -d /home/znv/code/centerpoint_prj/CenterPoint/det3d/ops/iou3d_nms/iou3d_nms_cuda.cpython-36m-x86_64-linux-gnu.so

Dynamic section at offset 0x4fbc8 contains 30 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libcudart.so.10.0]
 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libpthread.so.0]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000f (RPATH)              Library rpath: [/usr/local/cuda/lib64]
 0x000000000000000c (INIT)               0x7000
 0x000000000000000d (FINI)               0x1834c
 0x0000000000000019 (INIT_ARRAY)         0x509b0
 0x000000000000001b (INIT_ARRAYSZ)       40 (bytes)
 0x000000000000001a (FINI_ARRAY)         0x509d8
 0x000000000000001c (FINI_ARRAYSZ)       8 (bytes)
 0x000000006ffffef5 (GNU_HASH)           0x260
 0x0000000000000005 (STRTAB)             0x1fc8
 0x0000000000000006 (SYMTAB)             0x420
 0x000000000000000a (STRSZ)              8111 (bytes)
 0x000000000000000b (SYMENT)             24 (bytes)
 0x0000000000000003 (PLTGOT)             0x51000
 0x0000000000000002 (PLTRELSZ)           4776 (bytes)
 0x0000000000000014 (PLTREL)             RELA
 0x0000000000000017 (JMPREL)             0x4fb8
 0x0000000000000007 (RELA)               0x42f8
 0x0000000000000008 (RELASZ)             3264 (bytes)
 0x0000000000000009 (RELAENT)            24 (bytes)
 0x000000006ffffffe (VERNEED)            0x41c8
 0x000000006fffffff (VERNEEDNUM)         6
 0x000000006ffffff0 (VERSYM)             0x3f78
 0x000000006ffffff9 (RELACOUNT)          31
 0x0000000000000000 (NULL)               0x0
 
 不起作用
```

### 虚拟环境的准备

```shell
conda create --name centerpoint python=3.6 
conda activate centerpoint
pip install conda
#cuda_10.0.130_410.48_linux在如下目录
export DEBUG_INSTALLER_PATH=/home/znv/tools/gpu

conda install pytorch==1.1.0 torchvision==0.3.0 cudatoolkit=10.0 cudatoolkit-dev=10.0 --channel=conda-forge
conda install cudnn
conda install boost


```



### spconv编译安装



https://github.com/traveller59/spconv/issues/152

```shell

it clone https://github.com/traveller59/spconv.git --recursive
cd spconv && git checkout 7342772
python setup.py bdist_wheel
cd ./dist && pip install *

export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH
python -c 'import spconv'
```

http://ws.nju.edu.cn/blog/2019/10/在conda安装的cuda环境中安装apex/#more-1725

```
export LD_LIBRARY_PATH=/home/anaconda3/envs/centerpoint/lib:$LD_LIBRARY_PATH
```

## 2021-1-23

## 问题：_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol:

解决：对pytorch torchvision做了卸载安装，貌似好了。



## 报错 FileNotFoundError: [Errno 2] No such file or directory: 'demo/nuScenes/demo_infos.pkl'

下载相关的文件



## 2021-1-26

###  VSCode 连接远程服务器使用图形化界面（GUI）

https://blog.csdn.net/Dteam_f/article/details/109806294

可行的，windows上的x server建议从xming换成VcXSrv

### vlc 报错：VLC is not supposed to be run as root.

https://blog.csdn.net/byna11sina11/article/details/103475936

## 2021-1-27

###添加腾讯云的yum源

### 安装nccl库

从https://mirrors.cloud.tencent.com/nvidia-machine-learning/rhel7/x86_64/获取rpm包

```
-rw-r--r--. 1 root root   30555368 Mar 23  2020 libnccl-2.6.4-1+cuda10.0.x86_64.rpm
-rw-r--r--. 1 root root       7512 Mar 23  2020 libnccl-devel-2.6.4-1+cuda10.0.x86_64.rpm
-rw-r--r--. 1 root root   35019120 Mar 23  2020 libnccl-static-2.6.4-1+cuda10.0.x86_64.rpm
```

安装

```
(paddlex_czw) [root@localhost gpu]# rpm -ivh  libnccl-*.rpm
```

### paddle 预测库源码编译

https://paddle-inference.readthedocs.io/en/latest/user_guides/source_compile.html

增加支持tensorr

```shell
export PATH=/usr/local/cuda-10.0/bin${PATH:+:${PATH}}
export LD_LIBRARY_PATH=/usr/local/cuda-10.0/${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}

TENSORRT_ROOT=/home/paddlex/TensorRT/

# 创建并进入 build 目录
mkdir build_cuda && cd build_cuda
# 执行cmake指令
cmake .. -DPY_VERSION=3 \
        -DWITH_TESTING=OFF \
        -DWITH_MKL=ON \
        -DWITH_GPU=ON \
        -DON_INFER=ON \
        -DTENSORRT_ROOT=${TENSORRT_ROOT} \
        ..

make inference_lib_dist -j4
```



### linux外网加速

安装Qv2ray

https://qv2ray.net/getting-started/step1.html#opensuse-fedora-centos

https://snapcraft.io/install/qv2ray/centos

```shell

```

## 2021-1-28

### qt5安装

```
snap install qt551
```

### 运行qv2ray

```

export LD_LIBRARY_PATH=/var/lib/snapd/snap/qv2ray/4053/usr/lib/x86_64-linux-gnu:$LD_LIBRARY_PATH
```

### 升级glibc 系统一直保持segment fault等问题

https://blog.csdn.net/yanerhao/article/details/91045462

### git 设置取消代理

```
git config --global http.proxy 'socks5://10.45.148.155:10808' 
git config --global https.proxy 'socks5://10.45.148.155:10808'

git config --global --unset http.proxy
git config --global --unset https.proxy
```

wget设置代理

```
wget -c -r -np -k -L -p -e "http_proxy=socks5://10.45.148.155:10808" 
```



## 2021-1-29

###  Centos7.3+Xfce桌面+VNC服务+XRDP服务 实现远程桌面连接

https://www.huaweicloud.com/articles/09ca150d8080d4fbb8e32516afa66fac.html

### xming 升级到VcXsrv

https://zhuanlan.zhihu.com/p/128507562

https://github.com/ros-visualization/rqt_image_view/issues/9  使用Xming有些问题

###  ssh转发加速

https://bbs.pku.edu.cn/v2/post-read.php?bid=13&threadid=15281000

### TensorRT安装

参考[https://github.com/aimuch/iAI/blob/main/src/ai_base_env.md#%E5%AE%89%E8%A3%85tensorrt](https://github.com/aimuch/iAI/blob/main/src/ai_base_env.md#安装tensorrt)

```shell
#~/.bashrc 
LD_LIBRARY_PATH=/home/paddlex/TensorRT/lib:$LD_LIBRARY_PATH
export CUDA_INSTALL_DIR=/usr/local/cuda-10.0
export CUDNN_INSTALL_DIR=/usr/local/cuda-10.0
```

## 2021-2-1

###  haclon安装与运行

centos 7.6+halcon 20.05版本

参考https://blog.csdn.net/liubing8609/article/details/88046250

https://blog.csdn.net/xd19890922/article/details/103851061

```shell
#报错
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_init_ssl
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_init_crypto
qt.network.ssl: QSslSocket: cannot resolve ASN1_STRING_get0_data
qt.network.ssl: QSslSocket: cannot resolve EVP_CIPHER_CTX_reset
qt.network.ssl: QSslSocket: cannot resolve RSA_bits
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_sk_new_null
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_sk_push
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_sk_free
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_sk_num
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_sk_pop_free
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_sk_value
qt.network.ssl: QSslSocket: cannot resolve DH_get0_pqg
qt.network.ssl: QSslSocket: cannot resolve SSL_CTX_set_options
qt.network.ssl: QSslSocket: cannot resolve SSL_CTX_set_ciphersuites
qt.network.ssl: QSslSocket: cannot resolve SSL_set_psk_use_session_callback
qt.network.ssl: QSslSocket: cannot resolve SSL_get_client_random
qt.network.ssl: QSslSocket: cannot resolve SSL_SESSION_get_master_key
qt.network.ssl: QSslSocket: cannot resolve SSL_session_reused
qt.network.ssl: QSslSocket: cannot resolve SSL_set_options
qt.network.ssl: QSslSocket: cannot resolve TLS_method
qt.network.ssl: QSslSocket: cannot resolve TLS_client_method
qt.network.ssl: QSslSocket: cannot resolve TLS_server_method
qt.network.ssl: QSslSocket: cannot resolve X509_STORE_CTX_get0_chain
qt.network.ssl: QSslSocket: cannot resolve X509_getm_notBefore
qt.network.ssl: QSslSocket: cannot resolve X509_getm_notAfter
qt.network.ssl: QSslSocket: cannot resolve X509_get_version
qt.network.ssl: QSslSocket: cannot resolve X509_STORE_set_ex_data
qt.network.ssl: QSslSocket: cannot resolve X509_STORE_get_ex_data
qt.network.ssl: QSslSocket: cannot resolve OpenSSL_version_num
qt.network.ssl: QSslSocket: cannot resolve OpenSSL_version
qt.network.ssl: Incompatible version of OpenSSL
qt.network.ssl: QSslSocket::connectToHostEncrypted: TLS initialization failed
#解决
export LD_LIBRARY_PATH=/opt/halcon/lib/x64-linux/thirdparty:$LD_LIBRARY_PATH
#报错
[22060:22060:0201/122917.702743:ERROR:zygote_host_impl_linux.cc(89)] Running as root without --no-sandbox is not supported. See https://crbug.com/638180.
#解决
export QTWEBENGINE_DISABLE_SANDBOX=1
#运行
hdevelop
#可以正常运行


```

###  一台机器上运行多个glibc库

希望不升级系统的glibc库（升级会存在很多问题）

https://stackoverflow.com/questions/847179/multiple-glibc-libraries-on-a-single-host

This question is old, the other answers are old. "Employed Russian"s answer is very good and informative, but it only works if you have the source code. If you don't, the alternatives back then were very tricky. Fortunately nowadays we have a simple solution to this problem (as commented in one of his replies), using [patchelf](http://nixos.org/patchelf.html). All you have to do is:

```shell
 yum install patchelf
```



```c
$ ./patchelf --set-interpreter /path/to/newglibc/ld-linux.so.2 --set-rpath /path/to/newglibc/ myapp
//ld-linux.so.2更换成ld-linux-x86-64.so.2
```

And after that, you can just execute your file:

```c
$ ./myapp
```

No need to `chroot` or manually edit binaries, thankfully. But remember to backup your binary before patching it（记得二进制文件的备份）, if you're not sure what you're doing, because it modifies your binary file. After you patch it, you can't restore the old path to interpreter/rpath. If it doesn't work, you'll have to keep patching it until you find the path that will actually work... Well, it doesn't have to be a trial-and-error process. For example, in OP's example, he needed `GLIBC_2.3`, so you can easily find which lib provides that version using `strings`:

```c
$ strings /lib/i686/libc.so.6 | grep GLIBC_2.3
$ strings /path/to/newglib/libc.so.6 | grep GLIBC_2.3
```

In theory, the first grep would come empty because the system libc doesn't have the version he wants, and the 2nd one should output GLIBC_2.3 because it has the version `myapp` is using, so we know we can `patchelf` our binary using that path. If you get a segmentation fault, read the note at the end.

When you try to run a binary in linux, the binary tries to load the linker, then the libraries, and they should all be in the path and/or in the right place. If your problem is with the linker and you want to find out which path your binary is looking for, you can find out with this command:

```c
$ readelf -l myapp | grep interpreter
  [Requesting program interpreter: /lib/ld-linux.so.2]                                                                                                                                                                                   
```

If your problem is with the libs, commands that will give you the libs being used are:

```c
$ readelf -d myapp | grep Shared
$ ldd myapp 
```

This will list the libs that your binary needs, but you probably already know the problematic ones, since they are already yielding errors as in OP's case.

"patchelf" works for many different problems that you may encounter while trying to run a program, related to these 2 problems. For example, if you get: `ELF file OS ABI invalid`, it may be fixed by setting a new loader (the `--set-interpreter` part of the command) as I explain [here](https://stackoverflow.com/a/48654678/2193235). Another example is for the problem of getting `No such file or directory` when you run a file that is there and executable, as exemplified [here](https://superuser.com/questions/248512/why-do-i-get-command-not-found-when-the-binary-file-exists). In that particular case, OP was missing a link to the loader, but maybe in your case you don't have root access and can't create the link. Setting a new interpreter would solve your problem.

Thanks Employed Russian and Michael Pankov for the insight and solution!

------

*Note* for segmentation fault: you might be in the case where `myapp` uses several libs, and most of them are ok but some are not; then you `patchelf` it to a new dir, and you get segmentation fault. When you `patchelf` your binary, you change the path of several libs, even if some were originally in a different path. Take a look at my example below:

```c
$ ldd myapp
./myapp: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.20' not found (required by ./myapp)
./myapp: /usr/lib/x86_64-linux-gnu/libstdc++.so.6: version `GLIBCXX_3.4.21' not found (required by ./myapp)
        linux-vdso.so.1 =>  (0x00007fffb167c000)
        libm.so.6 => /lib/x86_64-linux-gnu/libm.so.6 (0x00007f9a9aad2000)
        libdl.so.2 => /lib/x86_64-linux-gnu/libdl.so.2 (0x00007f9a9a8ce000)
        libpthread.so.0 => /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f9a9a6af000)
        libstdc++.so.6 => /usr/lib/x86_64-linux-gnu/libstdc++.so.6 (0x00007f9a9a3ab000)
        libc.so.6 => /lib/x86_64-linux-gnu/libc.so.6 (0x00007f9a99fe6000)
        /lib64/ld-linux-x86-64.so.2 (0x00007f9a9adeb000)
        libgcc_s.so.1 => /lib/x86_64-linux-gnu/libgcc_s.so.1 (0x00007f9a99dcf000)
```

Note that most libs are in `/lib/x86_64-linux-gnu/` but the problematic one (`libstdc++.so.6`) is on `/usr/lib/x86_64-linux-gnu`. After I patchelf'ed `myapp` to point to `/path/to/mylibs`, I got segmentation fault. For some reason, the libs are not totally compatible with the binary. Since `myapp` didn't complain about the original libs, I copied them from `/lib/x86_64-linux-gnu/` to `/path/to/mylibs2`, and I also copied `libstdc++.so.6` from `/path/to/mylibs` there. Then I patchelf'ed it to `/path/to/mylibs2`, and `myapp` works now. If your binary uses different libs, and you have different versions, it might happen that you can't fix your situation. :( But if it's possible, mixing libs might be the way. It's not ideal, but *maybe* it will work. Good luck!

```shell
readelf -l ./PaddleX/PaddleX | grep interpreter

readelf -a ./PaddleX/PaddleX 

patchelf --set-interpreter /root/local/lib/ld-linux-x86-64.so.2 --set-rpath /root/local/lib/:/home/znv/code/paddle_prj/paddlex_gui_ubuntu1804_amd64/PaddleX  ./PaddleX/PaddleX

#运行还是有报错，等待centos 7版本吧
Traceback (most recent call last):
  File "paddlexui/PaddleX.py", line 15, in <module>
  File "/home/jiangjiajun/anaconda3/envs/paddlex/lib/python3.7/site-packages/PyInstaller/loader/pyimod03_importers.py", line 627, in exec_module
  File "paddlexui/PaddleXCore.py", line 23, in <module>
  File "/home/jiangjiajun/anaconda3/envs/paddlex/lib/python3.7/site-packages/PyInstaller/loader/pyimod03_importers.py", line 627, in exec_module
  File "paddlexui/main/__init__.py", line 18, in <module>
  File "/home/jiangjiajun/anaconda3/envs/paddlex/lib/python3.7/site-packages/PyInstaller/loader/pyimod03_importers.py", line 627, in exec_module
  File "paddlexui/main/window.py", line 14, in <module>
  File "/home/jiangjiajun/anaconda3/envs/paddlex/lib/python3.7/site-packages/PyInstaller/loader/pyimod03_importers.py", line 627, in exec_module
  File "site-packages/wx/__init__.py", line 17, in <module>
  File "/home/jiangjiajun/anaconda3/envs/paddlex/lib/python3.7/site-packages/PyInstaller/loader/pyimod03_importers.py", line 627, in exec_module
  File "site-packages/wx/core.py", line 12, in <module>
ImportError: libxcb.so.1: cannot open shared object file: No such file or directory
[17999] Failed to execute script PaddleX
```

## 2021-2-8

### jetson nano 的Ubuntu的国内镜像源配置

https://blog.csdn.net/baidu_26678247/article/details/108938351

### jetson nano的远程桌面配置

参考[https://d246810g2000.medium.com/nvidia-jetson-nano-for-jetpack-4-4-01-%E7%92%B0%E5%A2%83%E5%AE%89%E8%A3%9D-fd48d5658a13](https://d246810g2000.medium.com/nvidia-jetson-nano-for-jetpack-4-4-01-環境安裝-fd48d5658a13)

```shell
# 开机后启动 或设置成开机自启动
znv@znv-desktop:~$ ~/openvino 
```



```
Section "Screen" 
    Identifier "Default Screen" 
    Monitor "Configured Monitor" 
    Device "Default Device" 
    SubSection "Display" 
        Depth 24 
        Virtual 1280 720 
    EndSubSection 
EndSection
```



###  jetson nano的jetpack升级(从4.3到4.4)

https://www.jianshu.com/p/c763c5384cd2

https://docs.nvidia.com/jetson/jetpack/install-jetpack/index.html

需要设置下代理升级

```shell
sudo apt -o Acquire::http::proxy="http://10.45.149.80:10809/"   dist-upgrade
#卸载老版本
sudo apt autoremove --purge nvidia-container-csv-cuda libopencv-python libvisionworks-sfm-dev libvisionworks-dev libvisionworks-samples libnvparsers6 libcudnn7-doc libcudnn7-dev libnvinfer-samples libnvinfer-bin nvidia-container-csv-cudnn libvisionworks-tracking-dev vpi-samples tensorrt libopencv libnvinfer-doc libnvparsers-dev libcudnn7 libnvidia-container0 cuda-toolkit-10-0 nvidia-container-csv-visionworks graphsurgeon-tf libopencv-samples python-libnvinfer-dev libnvinfer-plugin-dev libnvinfer-plugin6 nvidia-container-toolkit libnvinfer-dev libvisionworks libopencv-dev nvidia-l4t-jetson-multimedia-api vpi-dev vpi python3-libnvinfer python3-libnvinfer-dev opencv-licenses nvidia-container-csv-tensorrt libnvinfer6 libnvonnxparsers-dev libnvonnxparsers6 uff-converter-tf nvidia-docker2 libvisionworks-sfm libnvidia-container-tools nvidia-container-runtime python-libnvinfer libvisionworks-tracking
#
sudo apt purge cuda-repo-l4t-10-0-local-10.0.326 libvisionworks-repo libvisionworks-sfm-repo libvisionworks-tracking-repo
#
sudo apt clean

#.输入命令获取APT 升级仓库列表:
$sudo apt update

#.输入命令显示可更新升级的软件包:
$apt list --upgradable

#.输入命令升级L4T包:
$sudo apt upgrade

#以上三步更新完成后，重启机器
#.打开apt source:
$ sudo vi /etc/apt/sources.list.d/nvidia-l4t-apt-source.list

#.修改仓库名称及URL 地址（deb）
#原始数据:
deb https://repo.download.nvidia.com/jetson/common r32 main
deb https://repo.download.nvidia.com/jetson/<platform> r32 main

#其中 <platform> 表示对应平台的处理器:
#•t186 for Jetson TX2 series
#•t194 for Jetson AGX Xavier series or Jetson Xavier NX
#•t210 for Jetson Nano or Jetson TX1

#修改后 r32 为 r32.4并对应准确的平台信息如Jetson Xavier :
deb https://repo.download.nvidia.com/jetson/common r32.4 main
deb https://repo.download.nvidia.com/jetson/t194 r32.4 main

#.保存并关闭apt source 配置文件

#安装新版本，增加代理已加速
sudo apt depends nvidia-jetpack | awk '{print $2}' | xargs -I {} sudo apt install -y {} -o Acquire::http::proxy="http://10.45.149.80:10809/" 
```

### 豆瓣源

```shell
 #~/.pip/pip.conf
[global]
index-url = https://pypi.doubanio.com/simple
trusted-host = pypi.doubanio.com
```

### jetson nano的虚拟环境的配置

https://blog.csdn.net/qq_19707521/article/details/103733994

```shell
#安装和配置virtualenv 
#创建一个虚拟环境
 mkvirtualenv czw_py3 -p python3
 #退出虚拟环境
 (czw_py3) znv@znv-desktop:~/.pip$ deactivate 
 #进入虚拟环境
znv@znv-desktop:~/.pip$ workon czw_py3
(czw_py3) znv@znv-desktop:~/.pip$ 
##虚拟环境的拷贝  源->目的
$ cpvirtualenv czw_py3 trt_yolov4-tiny_py3
```

## 2021-2-9

### jetson nano 上numpy 1.19.5版本执行报错

安装1.19.4版本

```shell
(czw_py3) znv@znv-desktop:~/code/demo/trt_yolov4-tiny/yolo$ python -c "import numpy as np"
Illegal instruction (core dumped)
(czw_py3) znv@znv-desktop:~/code/demo/trt_yolov4-tiny/yolo$ OPENBLAS_CORETYPE=ARMV8 python3 -c "import numpy"
(czw_py3) znv@znv-desktop:~/code/demo/trt_yolov4-tiny/yolo$ pip3 install numpy==1.19.4
(czw_py3) znv@znv-desktop:~/code/demo/trt_yolov4-tiny/yolo$ python -c "import numpy as np"
```

https://github.com/numpy/numpy/issues/18131



### tensorrt 的配置

```
After this you will also need to setup PYTHONPATH such that your dist-packages are included as part of your virtualenv. Add this to your .bashrc. This needs to be done because the python bindings to tensorrt are available in dist-packages and this folder is usually not visible to your virtualenv. To make them visible we add it to PYTHONPATH.
export PYTHONPATH=/usr/lib/python3.6/dist-packages:$PYTHONPATH
Test this change by switching to your virtualenv and importing tensorrt.
> import tensorrt as trt
> # This import should succeed
```

https://docs.donkeycar.com/guide/robot_sbc/tensorrt_jetson_nano/

#### ubuntu下查看USB摄像头参数

```shell
$ sudo apt install v4l-utils
$ v4l2-ctl -d  /dev/video0 --all
```

### pytorch torchvision安装

https://forums.developer.nvidia.com/t/pytorch-for-jetson-version-1-7-0-now-available/72048

https://blog.csdn.net/weixin_45709671/article/details/108909668

###  onnx升级



```
pip3 install -U --upgrade-strategy eager onnx-simplifier
```

## 2021-2-10

### nanodet 运行

```python
python3 trt_demo.py webcam --config nanodet-m.yml --model nanodet-m.trt --camid 0

```

## 2021-2-19

### deep stream SDK 安装

https://docs.nvidia.com/metropolis/deepstream/dev-guide/text/DS_Quickstart.html

```
sudo apt install deepstream-5.0 -o Acquire::http::proxy="http://10.45.149.80:10809/"
```

### deep stream app python样例

https://docs.nvidia.com/metropolis/deepstream/dev-guide/text/DS_Python_Sample_Apps.html

## 2021-3-1

### test-4样例

C++

```
./deepstream-test4-app -i ../../../data/car_1080p.avi -p /opt/nvidia/deepstream/deepstream/lib/libnvds_kafka_proto.so --conn-str="10.45.154.96;9092" --topic=deepstream-test -s 0 
```

python

```
python3 deepstream_test_4.py -i ../../../data/car_1080p.avi -p /opt/nvidia/deepstream/deepstream/lib/libnvds_kafka_proto.so --conn-str="10.45.154.96;9092;deepstream-test" --topic=deepstream-test -s 0 --cfg-file=cfg_kafka.txt 
```



## 2021-3-2

### vscode下调试C/C++程序

需要对3个配置文件做修改

https://code.visualstudio.com/docs/cpp/config-linux

- `tasks.json` (compiler build settings)
- `launch.json` (debugger settings)
- `c_cpp_properties.json` (compiler path and IntelliSense settings)

以deepstream 中的test-4程序为例：

c_cpp_properties.json

```json
{
    "configurations": [
        {
            "name": "Linux",
            "includePath": [
                "${workspaceFolder}/**",                
                "${workspaceFolder}/../../../includes",
                "/usr/include/glib-2.0",
                "/usr/lib/aarch64-linux-gnu/glib-2.0/include",
                "/usr/include/gstreamer-1.0/"
            ],
            "defines": [],
            "compilerPath": "/usr/bin/gcc",
            "cStandard": "gnu11",
            "cppStandard": "gnu++14",
            "intelliSenseMode": "linux-gcc-arm64"
        }
    ],
    "version": 4
}
```

launch.json

```json
{
    // Use IntelliSense to learn about possible attributes.
    // Hover to view descriptions of existing attributes.
    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        {
            "name": "gcc - Build and debug active file",
            "type": "cppdbg",
            "request": "launch",
            "program": "${fileDirname}/${fileBasenameNoExtension}",
            "args": [
                "-i",
                "/opt/nvidia/deepstream/deepstream/sources/data/car_1080p.avi",
                "-p",
                "/opt/nvidia/deepstream/deepstream/lib/libnvds_kafka_proto.so",
                "--conn-str=\"10.45.154.96;9092\"",
                "--topic=deepstream-test",
                "-s",
                "0" 
            ],
            "stopAtEntry": false,
            "cwd": "${workspaceFolder}",
            "environment": [],
            "externalConsole": false,
            "MIMode": "gdb",
            "setupCommands": [
                {
                    "description": "Enable pretty-printing for gdb",
                    "text": "-enable-pretty-printing",
                    "ignoreFailures": true
                }
            ],
            "preLaunchTask": "C/C++: gcc build active file",
            "miDebuggerPath": "/usr/bin/gdb"
        }
    ]
}
```

task.json

```json
{
    "tasks": [
        {
            "type": "cppbuild",
            "label": "C/C++: gcc build active file",
            "command": "/usr/bin/gcc",
            "args": [
                "-g",
                "${file}",
                "-o",
                "${fileDirname}/${fileBasenameNoExtension}",
                "-I",
                "/usr/include/gstreamer-1.0",
                "-I",
                "/usr/include/glib-2.0",
                "-I",
                "${workspaceFolder}/../../../includes",
                "-I",
                "/usr/lib/aarch64-linux-gnu/glib-2.0/include",
                "-L",
                "${workspaceFolder}/../../../../lib/",
                "-lgstreamer-1.0",
                "-lgobject-2.0",
                "-lglib-2.0",
                "-lnvdsgst_meta",
                "-lnvds_meta"
            ],
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Task generated by Debugger."
        }
    ],
    "version": "2.0.0"
}
```

### vscode调试python程序

以deepstream 中的test-4程序为例：

launch.json

```json
{
    // Use IntelliSense to learn about possible attributes.
    // Hover to view descriptions of existing attributes.
    // For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387
    "version": "0.2.0",
    "configurations": [
        {
            "name": "Python: Current File",
            "type": "python",
            "request": "launch",
            "program": "${file}",
            "console": "integratedTerminal",
            "args": [
                "-i",
                "/opt/nvidia/deepstream/deepstream/sources/data/car_1080p.avi",
                "-p",
                "/opt/nvidia/deepstream/deepstream/lib/libnvds_kafka_proto.so",
                "--conn-str=\"10.45.154.96;9092;deepstream-test\"",
                "--topic=deepstream-test",
                "-s",
                "0",
                "--cfg-file=cfg_kafka.txt",
                "--no-display"
            ]
        }
    ]
}
```



### 调试出现报错



```
Unable to write file 'vscode-remote://ssh-remote+7b22686f73744e616d65223a227562756e74755f4a6574736f6e4e616e6f5f3134382e313137227d/build/glibc-D9JkfM/glibc-2.27/elf/dl-error-skeleton.c' (NoPermissions (FileSystemError): Error: EACCES: permission denied, mkdir '/build')

Unable to open 'dl-error-skeleton.c': Unable to read file 'vscode-remote://ssh-remote+7b22686f73744e616d65223a227562756e74755f4a6574736f6e4e616e6f5f3134382e313137227d/build/glibc-D9JkfM/glibc-2.27/elf/dl-error-skeleton.c' (Error: Unable to resolve non-existing file 'vscode-remote://ssh-remote+7b22686f73744e616d65223a227562756e74755f4a6574736f6e4e616e6f5f3134382e313137227d/build/glibc-D9JkfM/glibc-2.27/elf/dl-error-skeleton.c').
```

暂无解决思路

## 2021-3-5

### opencv编译安装

https://paddlex.readthedocs.io/zh_CN/develop/deploy/opencv.html

```
cmake -DCMAKE_BUILD_TYPE=RELEASE -DCMAKE_INSTALL_PREFIX=/home/paddlex/opencv-3.4.6/build/opencv3.4.6gcc7.3ffmpeg -D WITH_FFMPEG=ON ..
```

## 2021-3-6

### 点云压缩

https://github.com/horizon-research/Real-Time-Spatio-Temporal-LiDAR-Point-Cloud-Compression/tree/master/src

```shell
 $ ./pcc_encoder --path ../data --file 0000000000.bin -p 0.18 -y 0.45 -f binary -l 4 -t 0.5 --out frame.tar.gz
 
 $ ./pcc_decoder -p 0.18 -y 0.45 -f binary -l 4 --file frame.tar.gz
  
 $  ./pcc_test --file ../data/0000000000.bin -p 0.18 -y 0.45 -f binary -l 4 -t 0.5 
 
 $ ./pcc_stream_encoder  -p 0.18 -y 0.45 -f binary -l 4 -t 0.5 --out frames.tar.gz --input-path ../data --input-files  0000000000.bin  0000000001.bin  0000000002.bin  0000000003.bin  0000000004.bin
 
 $ ./pcc_stream_decoder  -p 0.18 -y 0.45 -f binary -l 4 --input frames.tar.gz
 
 $ ./pcc_stream_test  -p 0.18 -y 0.45 -f binary -l 4 -t 0.5 --out frames.tar.gz --input-path ../data --input-files  0000000000.bin  0000000001.bin  0000000002.bin  0000000003.bin  0000000004.bin
   
```

### vscode的tasks.json使用pkg-config的方法

https://blog.csdn.net/qq570437459/article/details/107303792

https://stackoverflow.com/questions/44576801/how-to-use-pkg-config-gtkmm-3-0-cflags-libs-in-the-visual-studio-code

以下是在命令行中使用pkg-config的方法

g++ test.cpp  `pkg-config --cflags --libs opencv`
1
但是如果在tasks.json的编译选项中直接加入"\`pkg-config --cflags --libs opencv`"会导致编译报错。

解决办法：
tasks.json里的编译参数要使用下面的写法

"\`pkg-config","--libs","--cflags","opencv`",
————————————————
还是报错，增加环境变量PKG_CONFIG_PATH

```json
{
    "tasks": [
        {
            "type": "cppbuild",
            "label": "C/C++: g++ build active file",
            "command": "/opt/rh/devtoolset-7/root/usr/bin/g++",
            "args": [
                "-g",
                "${file}",
                "${fileDirname}/utils.cpp",
                "${fileDirname}/encoder.cpp",   
                "${fileDirname}/pcc_module.cpp",
                "${fileDirname}/decoder.cpp",
                "${fileDirname}/io.cpp",
                "-o",
                "${fileDirname}/${fileBasenameNoExtension}",
                "-I",
                "${workspaceFolder}/src/",
                "-I",
                "/home/paddlex/opencv-3.4.6/build/opencv3.4.6gcc7.3ffmpeg/include",
                "-lboost_program_options",
                "-lboost_system",
                "`pkg-config", "opencv", "--cflags", "--libs`",
            ],
            "options": {
                "cwd": "${workspaceFolder}",
                "env": {
                    "PKG_CONFIG_PATH":"/home/paddlex/opencv-3.4.6/build/opencv3.4.6gcc7.3ffmpeg/lib64/pkgconfig:${PKG_CONFIG_PATH}"
                }
            },
            "problemMatcher": [
                "$gcc"
            ],
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "detail": "Task generated by Debugger."
        }
    ],
    "version": "2.0.0"
}
```

## 2021-3-12

### gstreamer使用

```shell
gst-launch-1.0 uridecodebin uri="rtsp://admin:znv123456@10.45.147.10:554/cam/realmonitor?channel=1&subtype=0"! ffmpegcolorspace ! autovideosink
#海康摄像头
rtsp://admin:admin12345@10.45.148.180:554/h264/ch1/main/av_stream
#大华摄像头
rtsp://admin:znv123456@10.45.147.10:554/cam/realmonitor?channel=1&subtype=0


#编码 推流

gst-launch-1.0 v4l2src ! video/x-raw-yuv,width=640,height=480 ! x264enc ! rtph264pay ! udpsink host=10.45.154.155 port=10008


#拉流 解码 显示 ：ok
gst-launch-1.0 rtspsrc location=\"rtsp://admin:admin12345@10.45.148.180:554/h264/ch1/main/av_stream\" latency=0 ! rtph264depay ! h264parse ! omxh264dec ! nvvidconv ! xvimagesink sync=false
#拉流 解码 显示 ：error
gst-launch-1.0 rtspsrc location=\"rtsp://admin:admin12345@10.45.148.180:554/Streaming/Channels/101?transportmode=unicast&profile=Profile_1\" latency=0 ! rtph264depay ! h264parse ! omxh264dec ! nvvidconv ! xvimagesink sync=false

```

