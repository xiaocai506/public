## 2021-1-12

###安装xrdp用到

```
chcon -h system_u:object_r:bin_t:s0 /usr/sbin/xrdp
chcon -h system_u:object_r:bin_t:s0 /usr/sbin/xrdp-sesman
```

### GPU服务器安装x windows后startx失败解决

报错

```
no screens found
```

执行

```shell
root #nvidia-xconfig #仍然失败，

查看日志vi /var/log/Xorg.1.log，决定重装nvidia驱动

仍报错“Failed to load module "glxservernvidia" (module does not exist, 0)”

/etc/X11 文件夹下的conf文件删除
```

## 2021-1-15

cetnos 7 server带桌面 安装nvidia驱动问题：

问题1：

```
You appear to be running an X server
```

解决：

```
init 3 #切换到文本模式
```

问题2：

```
ERROR: The Nouveau kernel driver is currently in use by your system. This

    driver is incompatible with the NVIDIA driver, and must be disabled

    before proceeding. Please consult the NVIDIA driver README and your

    Linux distribution's documentation for details on how to correctly

    disable the Nouveau kernel driver.
```

解决：

```
解决办法如下：

    也即关闭Nouveau：

    1)把驱动加入黑名单中: /etc/modprobe.d/blacklist.conf 在后面加入：

    blacklist nouveau

    2) 使用 dracut重新建立 initramfs image file :

    * 备份 the initramfs file

    $ sudo mv /boot/initramfs-$(uname -r).img /boot/initramfs-$(uname -r).img.bak

    * 重新建立 the initramfs file

    $ sudo dracut -v /boot/initramfs-$(uname -r).img $(uname -r)

    3) 重启系统至文本模式,init 3 这个可以修改/etc/inittab 文件 init 3是文本模式,

    init 5是图形界面模式.重启之后,进入文本模式，其实可以发现字体变大了,也就是说驱动没有被加载,成功禁用了Nouveau

    4)检查nouveau driver确保没有被加载！

    $ lsmod | grep nouveau
```

###Centos7 安装VNC实现远程桌面

https://blog.csdn.net/weixin_41004350/article/details/80805927

###Centos xrdp 远程连接后突然闪退

原因见：https://blog.csdn.net/weixin_38170829/article/details/101087050?utm_medium=distribute.pc_relevant.none-task-blog-searchFromBaidu-1.control&depth_1-utm_source=distribute.pc_relevant.none-task-blog-searchFromBaidu-1.control

解决，修改~/.bashrc文件

```shell
# .bashrc

# User specific aliases and functions

alias rm='rm -i'
alias cp='cp -i'
alias mv='mv -i'

# Source global definitions
if [ -f /etc/bashrc ]; then
        . /etc/bashrc
fi

:<<!
#>>> conda initialize >>>
# !! Contents within this block are managed by 'conda init' !!
__conda_setup="$('/home/anaconda3/bin/conda' 'shell.bash' 'hook' 2> /dev/null)"
if [ $? -eq 0 ]; then
    eval "$__conda_setup"
else
    if [ -f "/home/anaconda3/etc/profile.d/conda.sh" ]; then
        . "/home/anaconda3/etc/profile.d/conda.sh"
    else
        export PATH="/home/anaconda3/bin:$PATH"
    fi
fi
unset __conda_setup
#<<< conda initialize <<<
!

export PATH=$PATH:/home/anaconda3/bin:/home/anaconda3/condabin
```

```shell
[root@localhost ~]# echo $PATH
/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/home/anaconda3/bin:/home/anaconda3/condabin:/root/bin
```



### 寒武纪服务器上从github快速下载

```shell
#例子
wget -c -O "pcl-1.11.1.source.tar.gz" "https://github-production-release-asset-2e65be.s3.amazonaws.com/8162615/b01c9780-de82-11ea-84fe-ed209592d841?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIWNJYAX4CSVEH53A%2F20210115%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20210115T064425Z&X-Amz-Expires=300&X-Amz-Signature=a01c0a2ecb578b4d7ca39442be98bbf4830bb2cb55caa817833b21c723dc8929&X-Amz-SignedHeaders=host&actor_id=2957099&key_id=0&repo_id=8162615&response-content-disposition=attachment%3B%20filename%3Dsource.tar.gz&response-content-type=application%2Foctet-stream"
```

### centos 7安装cmake 3

https://tlanyan.me/install-cmake3-on-centos-7/

## 2021-1-16

### boost编译安装

https://blog.csdn.net/u011641865/article/details/73498533

### openni 编译安装(编译失败)

https://github.com/OpenNI/OpenNI

## 2021-1-18

### vncserver 设置屏幕分辨率

https://blog.csdn.net/yangcs2009/article/details/9789845

### xrdp+vnc的复制黏贴问题

https://blog.csdn.net/dongfangxiaozi_/article/details/72621974?utm_medium=distribute.pc_relevant_bbs_down.none-task--2~all~sobaiduend~default-3.nonecase&depth_1-utm_source=distribute.pc_relevant_bbs_down.none-task--2~all~sobaiduend~default-3.nonecase

上面的方法，一锁屏就失效，

https://www.cnblogs.com/zhaopengcheng/p/6067262.html

windows侧也要设置下https://www.huaweicloud.com/articles/dd5dd28089d34bb4886c8b2fae6b85b6.html



###  conda activate报错

https://blog.csdn.net/weixin_42652125/article/details/87697902

### 日常操作

```
scp -P 32285  root@120.236.247.203:/home/datasets/semantic3d/bildstein_station1_xyz_intensity_rgb.7z ./

scp -P 32285  root@120.236.247.203:/home/datasets/semantic3d/sem8_labels_training.7z ./
scp -P 32285  root@120.236.247.203:/home/datasets/semantic3d/sg27_station2_intensity_rgb.7z ./


wget -c -O "sg27_station2_intensity_rgb.7z" "http://semantic3d.net/data/point-clouds/training1/sg27_station2_intensity_rgb.7z"

/home/disk1/NuScenes/nuscenes/     10.45.157.0/20(rw,sync,no_root_squash,no_all_squash)
```

### anaconda 国内镜像

https://blog.csdn.net/weixin_43667077/article/details/106521015

### nfs 配置

https://abelsu7.top/2019/10/17/centos7-install-nfs/

https://www.itread01.com/content/1535442980.html

## 2021-1-19

### centerpoint 操作

```shell
# nuScenes
python tools/create_data.py nuscenes_data_prep --root_path=/home/znv/code/centerpoint_prj/CenterPoint/data/nuScenes --version="v1.0-trainval" --nsweeps=10



# set the cuda path(change the path to your own cuda location) 
#export PATH=/usr/local/cuda/bin:$PATH #这个环境变量不需要，加上会有问题@20210123
export CUDA_PATH=/usr/local/cuda
export CUDA_HOME=/usr/local/cuda
export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH
bash setup.sh 
```

```shell
#遇到报错
(centerpoint) [root@localhost CenterPoint]# python tools/demo.py 
iou3d cuda not built. You don't need this if you use circle_nms. Otherwise, refer to the advanced installation part to build this cuda extension
No Tensorflow
Deformable Convolution not built!
Traceback (most recent call last):
  File "tools/demo.py", line 16, in <module>
    from det3d.models import build_detector
  File "/home/znv/code/centerpoint_prj/CenterPoint/det3d/models/__init__.py", line 29, in <module>
    from .roi_heads import * 
  File "/home/znv/code/centerpoint_prj/CenterPoint/det3d/models/roi_heads/__init__.py", line 1, in <module>
    from .roi_head_template import RoIHeadTemplate
  File "/home/znv/code/centerpoint_prj/CenterPoint/det3d/models/roi_heads/roi_head_template.py", line 12, in <module>
    from .target_assigner.proposal_target_layer import ProposalTargetLayer
  File "/home/znv/code/centerpoint_prj/CenterPoint/det3d/models/roi_heads/target_assigner/proposal_target_layer.py", line 11, in <module>
    from ....ops.iou3d_nms.iou3d_nms_utils import boxes_iou3d_gpu
  File "/home/znv/code/centerpoint_prj/CenterPoint/det3d/ops/iou3d_nms/__init__.py", line 1, in <module>
    from det3d.ops.iou3d_nms import iou3d_nms_cuda, iou3d_nms_utils
ImportError: /home/znv/code/centerpoint_prj/CenterPoint/det3d/ops/iou3d_nms/iou3d_nms_cuda.cpython-36m-x86_64-linux-gnu.so: undefined symbol: _ZN3c105ErrorC1ENS_14SourceLocationERKSs

(centerpoint) [root@localhost CenterPoint]# readelf -d /home/znv/code/centerpoint_prj/CenterPoint/det3d/ops/iou3d_nms/iou3d_nms_cuda.cpython-36m-x86_64-linux-gnu.so

Dynamic section at offset 0x4fbc8 contains 30 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libcudart.so.10.0]
 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libpthread.so.0]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000f (RPATH)              Library rpath: [/home/anaconda3/envs/centerpoint/lib:usr/local/cuda/lib]
 0x000000000000000c (INIT)               0x7000
 0x000000000000000d (FINI)               0x1834c
 0x0000000000000019 (INIT_ARRAY)         0x509b0
 0x000000000000001b (INIT_ARRAYSZ)       40 (bytes)
 0x000000000000001a (FINI_ARRAY)         0x509d8
 0x000000000000001c (FINI_ARRAYSZ)       8 (bytes)
 0x000000006ffffef5 (GNU_HASH)           0x260
 0x0000000000000005 (STRTAB)             0x1fc8
 0x0000000000000006 (SYMTAB)             0x420
 0x000000000000000a (STRSZ)              8111 (bytes)
 0x000000000000000b (SYMENT)             24 (bytes)
 0x0000000000000003 (PLTGOT)             0x51000
 0x0000000000000002 (PLTRELSZ)           4776 (bytes)
 0x0000000000000014 (PLTREL)             RELA
 0x0000000000000017 (JMPREL)             0x4fb8
 0x0000000000000007 (RELA)               0x42f8
 0x0000000000000008 (RELASZ)             3264 (bytes)
 0x0000000000000009 (RELAENT)            24 (bytes)
 0x000000006ffffffe (VERNEED)            0x41c8
 0x000000006fffffff (VERNEEDNUM)         6
 0x000000006ffffff0 (VERSYM)             0x3f78
 0x000000006ffffff9 (RELACOUNT)          31
 0x0000000000000000 (NULL)               0x0
 
 (centerpoint) [root@localhost CenterPoint]# chrpath -r "/usr/local/cuda/lib64"  /home/znv/code/centerpoint_prj/CenterPoint/det3d/ops/iou3d_nms/iou3d_nms_cuda.cpython-36m-x86_64-linux-gnu.so
/home/znv/code/centerpoint_prj/CenterPoint/det3d/ops/iou3d_nms/iou3d_nms_cuda.cpython-36m-x86_64-linux-gnu.so: RPATH=/home/anaconda3/envs/centerpoint/lib
/home/znv/code/centerpoint_prj/CenterPoint/det3d/ops/iou3d_nms/iou3d_nms_cuda.cpython-36m-x86_64-linux-gnu.so: new RPATH: /usr/local/cuda/lib64
(centerpoint) [root@localhost CenterPoint]# readelf -d /home/znv/code/centerpoint_prj/CenterPoint/det3d/ops/iou3d_nms/iou3d_nms_cuda.cpython-36m-x86_64-linux-gnu.so

Dynamic section at offset 0x4fbc8 contains 30 entries:
  Tag        Type                         Name/Value
 0x0000000000000001 (NEEDED)             Shared library: [libcudart.so.10.0]
 0x0000000000000001 (NEEDED)             Shared library: [libstdc++.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libm.so.6]
 0x0000000000000001 (NEEDED)             Shared library: [libgcc_s.so.1]
 0x0000000000000001 (NEEDED)             Shared library: [libpthread.so.0]
 0x0000000000000001 (NEEDED)             Shared library: [libc.so.6]
 0x000000000000000f (RPATH)              Library rpath: [/usr/local/cuda/lib64]
 0x000000000000000c (INIT)               0x7000
 0x000000000000000d (FINI)               0x1834c
 0x0000000000000019 (INIT_ARRAY)         0x509b0
 0x000000000000001b (INIT_ARRAYSZ)       40 (bytes)
 0x000000000000001a (FINI_ARRAY)         0x509d8
 0x000000000000001c (FINI_ARRAYSZ)       8 (bytes)
 0x000000006ffffef5 (GNU_HASH)           0x260
 0x0000000000000005 (STRTAB)             0x1fc8
 0x0000000000000006 (SYMTAB)             0x420
 0x000000000000000a (STRSZ)              8111 (bytes)
 0x000000000000000b (SYMENT)             24 (bytes)
 0x0000000000000003 (PLTGOT)             0x51000
 0x0000000000000002 (PLTRELSZ)           4776 (bytes)
 0x0000000000000014 (PLTREL)             RELA
 0x0000000000000017 (JMPREL)             0x4fb8
 0x0000000000000007 (RELA)               0x42f8
 0x0000000000000008 (RELASZ)             3264 (bytes)
 0x0000000000000009 (RELAENT)            24 (bytes)
 0x000000006ffffffe (VERNEED)            0x41c8
 0x000000006fffffff (VERNEEDNUM)         6
 0x000000006ffffff0 (VERSYM)             0x3f78
 0x000000006ffffff9 (RELACOUNT)          31
 0x0000000000000000 (NULL)               0x0
 
 不起作用
```

### 虚拟环境的准备

```shell
conda create --name centerpoint python=3.6 
conda activate centerpoint
pip install conda
#cuda_10.0.130_410.48_linux在如下目录
export DEBUG_INSTALLER_PATH=/home/znv/tools/gpu

conda install pytorch==1.1.0 torchvision==0.3.0 cudatoolkit=10.0 cudatoolkit-dev=10.0 --channel=conda-forge
conda install cudnn
conda install boost


```



### spconv编译安装



https://github.com/traveller59/spconv/issues/152

```shell

it clone https://github.com/traveller59/spconv.git --recursive
cd spconv && git checkout 7342772
python setup.py bdist_wheel
cd ./dist && pip install *

export LD_LIBRARY_PATH=/usr/local/cuda/lib64:$LD_LIBRARY_PATH
python -c 'import spconv'
```

http://ws.nju.edu.cn/blog/2019/10/在conda安装的cuda环境中安装apex/#more-1725

```
export LD_LIBRARY_PATH=/home/anaconda3/envs/centerpoint/lib:$LD_LIBRARY_PATH
```

## 2021-1-23

## 问题：_C.cpython-36m-x86_64-linux-gnu.so: undefined symbol:

解决：对pytorch torchvision做了卸载安装，貌似好了。



## 报错 FileNotFoundError: [Errno 2] No such file or directory: 'demo/nuScenes/demo_infos.pkl'

下载相关的文件



## 2021-1-26

###  VSCode 连接远程服务器使用图形化界面（GUI）

https://blog.csdn.net/Dteam_f/article/details/109806294

可行的，windows上的x server建议从xming换成VcXSrv

### vlc 报错：VLC is not supposed to be run as root.

https://blog.csdn.net/byna11sina11/article/details/103475936

## 2021-1-27

###添加腾讯云的yum源

### 安装nccl库

从https://mirrors.cloud.tencent.com/nvidia-machine-learning/rhel7/x86_64/获取rpm包

```
-rw-r--r--. 1 root root   30555368 Mar 23  2020 libnccl-2.6.4-1+cuda10.0.x86_64.rpm
-rw-r--r--. 1 root root       7512 Mar 23  2020 libnccl-devel-2.6.4-1+cuda10.0.x86_64.rpm
-rw-r--r--. 1 root root   35019120 Mar 23  2020 libnccl-static-2.6.4-1+cuda10.0.x86_64.rpm
```

安装

```
(paddlex_czw) [root@localhost gpu]# rpm -ivh  libnccl-*.rpm
```

### paddle 预测库源码编译

https://paddle-inference.readthedocs.io/en/latest/user_guides/source_compile.html

增加支持tensorr

```shell
export PATH=/usr/local/cuda-10.0/bin${PATH:+:${PATH}}
export LD_LIBRARY_PATH=/usr/local/cuda-10.0/${LD_LIBRARY_PATH:+:${LD_LIBRARY_PATH}}

TENSORRT_ROOT=/home/paddlex/TensorRT/

# 创建并进入 build 目录
mkdir build_cuda && cd build_cuda
# 执行cmake指令
cmake .. -DPY_VERSION=3 \
        -DWITH_TESTING=OFF \
        -DWITH_MKL=ON \
        -DWITH_GPU=ON \
        -DON_INFER=ON \
        -DTENSORRT_ROOT=${TENSORRT_ROOT} \
        ..

make inference_lib_dist -j4
```



### linux外网加速

安装Qv2ray

https://qv2ray.net/getting-started/step1.html#opensuse-fedora-centos

https://snapcraft.io/install/qv2ray/centos

```shell

```

## 2021-1-28

### qt5安装

```
snap install qt551
```

### 运行qv2ray

```

export LD_LIBRARY_PATH=/var/lib/snapd/snap/qv2ray/4053/usr/lib/x86_64-linux-gnu:$LD_LIBRARY_PATH
```

### 升级glibc 系统一直保持segment fault等问题

https://blog.csdn.net/yanerhao/article/details/91045462

### git 设置取消代理

```
git config --global http.proxy 'socks5://10.45.148.17:10808' 
git config --global https.proxy 'socks5://10.45.148.17:10808'

git config --global --unset http.proxy
git config --global --unset https.proxy
```

## 2021-1-29

###  Centos7.3+Xfce桌面+VNC服务+XRDP服务 实现远程桌面连接

https://www.huaweicloud.com/articles/09ca150d8080d4fbb8e32516afa66fac.html

### xming 升级到VcXsrv

https://zhuanlan.zhihu.com/p/128507562

https://github.com/ros-visualization/rqt_image_view/issues/9  使用Xming有些问题

###  ssh转发加速

https://bbs.pku.edu.cn/v2/post-read.php?bid=13&threadid=15281000

### TensorRT安装

参考[https://github.com/aimuch/iAI/blob/main/src/ai_base_env.md#%E5%AE%89%E8%A3%85tensorrt](https://github.com/aimuch/iAI/blob/main/src/ai_base_env.md#安装tensorrt)

```shell
#~/.bashrc 
LD_LIBRARY_PATH=/home/paddlex/TensorRT/lib:$LD_LIBRARY_PATH
export CUDA_INSTALL_DIR=/usr/local/cuda-10.0
export CUDNN_INSTALL_DIR=/usr/local/cuda-10.0
```

## 2021-2-1

###  haclon安装与运行

参考https://blog.csdn.net/liubing8609/article/details/88046250

https://blog.csdn.net/xd19890922/article/details/103851061

```shell
#报错
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_init_ssl
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_init_crypto
qt.network.ssl: QSslSocket: cannot resolve ASN1_STRING_get0_data
qt.network.ssl: QSslSocket: cannot resolve EVP_CIPHER_CTX_reset
qt.network.ssl: QSslSocket: cannot resolve RSA_bits
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_sk_new_null
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_sk_push
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_sk_free
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_sk_num
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_sk_pop_free
qt.network.ssl: QSslSocket: cannot resolve OPENSSL_sk_value
qt.network.ssl: QSslSocket: cannot resolve DH_get0_pqg
qt.network.ssl: QSslSocket: cannot resolve SSL_CTX_set_options
qt.network.ssl: QSslSocket: cannot resolve SSL_CTX_set_ciphersuites
qt.network.ssl: QSslSocket: cannot resolve SSL_set_psk_use_session_callback
qt.network.ssl: QSslSocket: cannot resolve SSL_get_client_random
qt.network.ssl: QSslSocket: cannot resolve SSL_SESSION_get_master_key
qt.network.ssl: QSslSocket: cannot resolve SSL_session_reused
qt.network.ssl: QSslSocket: cannot resolve SSL_set_options
qt.network.ssl: QSslSocket: cannot resolve TLS_method
qt.network.ssl: QSslSocket: cannot resolve TLS_client_method
qt.network.ssl: QSslSocket: cannot resolve TLS_server_method
qt.network.ssl: QSslSocket: cannot resolve X509_STORE_CTX_get0_chain
qt.network.ssl: QSslSocket: cannot resolve X509_getm_notBefore
qt.network.ssl: QSslSocket: cannot resolve X509_getm_notAfter
qt.network.ssl: QSslSocket: cannot resolve X509_get_version
qt.network.ssl: QSslSocket: cannot resolve X509_STORE_set_ex_data
qt.network.ssl: QSslSocket: cannot resolve X509_STORE_get_ex_data
qt.network.ssl: QSslSocket: cannot resolve OpenSSL_version_num
qt.network.ssl: QSslSocket: cannot resolve OpenSSL_version
qt.network.ssl: Incompatible version of OpenSSL
qt.network.ssl: QSslSocket::connectToHostEncrypted: TLS initialization failed
#解决
export LD_LIBRARY_PATH=/opt/halcon/lib/x64-linux/thirdparty:$LD_LIBRARY_PATH
#报错
[22060:22060:0201/122917.702743:ERROR:zygote_host_impl_linux.cc(89)] Running as root without --no-sandbox is not supported. See https://crbug.com/638180.
#解决
export QTWEBENGINE_DISABLE_SANDBOX=1
#运行
hdevelop


```

